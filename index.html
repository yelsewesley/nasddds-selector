<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NASDDDS Prompt Selector</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin:0; background:#f4f7f9; color:#2c3e50; font-size:15px; }
    .topbar { padding:10px; background:#fff; border-bottom:1px solid #ccc; display:flex; gap:10px; align-items:center; }
    input[type="text"]{ flex:1; padding:5px; font-size:14px; border:1px solid #ccc; border-radius:4px; }
    button{ padding:5px 10px; font-size:14px; background:#006699; color:#fff; border:none; border-radius:4px; cursor:pointer; }
    button:hover{ background:#004466; }
    .container{ display:flex; flex-wrap:wrap; min-height:calc(100vh - 40px); }
    .main{ flex:1; max-width:80%; padding:10px 20px; overflow-y:auto; }
    .sidebar{ width:20%; padding:20px; background:#fff; border-left:1px solid #ccc; position:sticky; top:40px; min-height:calc(100vh - 40px); }
    details.accordion{ background:#fff; border-radius:4px; margin-bottom:10px; box-shadow:0 2px 4px rgba(0,0,0,0.05); }
    summary.accordion-header{ padding:15px; font-weight:bold; cursor:pointer; background:#e9eff3; }
    .accordion-content{ padding:15px; }
    .select-all, .clear-all{ margin:5px 5px 10px 0; }
    .subheader{ margin:10px 0 5px; font-weight:bold; }
    .subgroup div{ margin-left:15px; }
    .highlight{ background:#fff3cd; }
    pre#summary{ width:100%; padding:10px; border:1px solid #ccc; border-radius:4px; background:#fff; white-space: pre-wrap; overflow-x:hidden; }
  </style>
</head>
<body>
  <div class="topbar">
    <input type="text" id="filterInput" placeholder="Search...">
    <button id="clearSearchBtn">Clear</button>
    <button id="exportWordBtn">Export Word</button>
    <button id="exportPdfBtn">Export PDF</button>
  </div>
  <div class="container">
    <div class="main">
      <div style="margin-bottom:20px;background:#eef5fa;border-left:4px solid #006699;padding:10px;">
        <strong>How to Use:</strong><br>
        Search to filter. Tap header to expand/collapse. Use Select All/Clear All. Selections appear in the summary.
      </div>

      <!-- INSERT THE ACCORDION HTML HERE GENERATED FROM YOUR PYTHON SCRIPT -->

    </div>
    <div class="sidebar">
      <h2>Selected Summary</h2>
      <pre id="summary"></pre>
    </div>
  </div>
  <script>
document.body.addEventListener('click', e => {
  if(e.target.matches('.select-all')||e.target.matches('.clear-all')){
    const chk = e.target.matches('.select-all');
    e.target.closest('.accordion-content').querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=chk);
    updateSummary();
  }
  if(e.target.id==='clearSearchBtn'){filterInput.value='';applyFilter();}
  if(e.target.id==='exportWordBtn')exportWord();
  if(e.target.id==='exportPdfBtn')exportPDF();
});
document.body.addEventListener('change', e=>{if(e.target.matches('input[type="checkbox"]'))updateSummary();});
const filterInput=document.getElementById('filterInput');
filterInput.addEventListener('input',applyFilter);
function applyFilter(){
  const term=filterInput.value.trim().toLowerCase();
  document.querySelectorAll('details.accordion').forEach(det=>{
    let any=false;
    det.querySelectorAll('input[type="checkbox"]').forEach(cb=>{
      const show=!term||cb.dataset.text.toLowerCase().includes(term);
      cb.parentElement.style.display=show?'':'none';
      det.querySelector(`label[for="${cb.id}"]`).classList.toggle('highlight',term&&show);
      if(show)any=true;
    });
    det.style.display=any||!term?'':'none';
  });
}
function updateSummary(){
  const checked=Array.from(document.querySelectorAll('input[type="checkbox"]:checked'));
  const groups={};
  checked.forEach(cb=>{
    const s=cb.dataset.sheet,p=cb.dataset.prompt,t=cb.dataset.text;
    groups[s]=groups[s]||{};
    groups[s][p]=groups[s][p]||[];
    groups[s][p].push(t);
  });
  let out='';
  Object.entries(groups).forEach(([s,pr])=>{
    out+=`--- ${s} ---\\n`;
    Object.entries(pr).forEach(([p,qs])=>{
      out+=`  • ${p}\\n`;
      qs.forEach(q=>out+=`    – ${q}\\n`);
      out+='\\n';
    });
  });
  document.getElementById('summary').textContent=out.trim();
}
function exportWord(){
  const content=document.getElementById('summary').textContent;
  const blob=new Blob([content],{type:'application/msword'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='selected_questions.doc';
  a.click();
}
function exportPDF(){
  const content=document.getElementById('summary').textContent;
  const win=window.open();
  win.document.write(`<pre>${content}</pre>`);
  win.document.close();
  win.print();
  win.close();
}
applyFilter(); updateSummary();
  </script>
</body>
</html>
